<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Incoming Call</title>
<style>
  *, *::before, *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  html, body {
    height: 100%;
    overflow: hidden;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'SF Pro Display', Roboto, Helvetica, Arial, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    touch-action: none;
    user-select: none;
    -webkit-user-select: none;
  }

  /* Call Screen */
  .call-screen {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(165deg, #1a1a2e 0%, #16213e 40%, #0f3460 100%);
    padding: env(safe-area-inset-top, 40px) 24px calc(env(safe-area-inset-bottom, 20px) + 32px);
    transition: opacity 0.5s ease, transform 0.5s ease;
    z-index: 10;
  }

  .call-screen.hidden {
    opacity: 0;
    transform: scale(1.05);
    pointer-events: none;
  }

  .caller-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 12vh;
  }

  .avatar-ring {
    position: relative;
    width: 120px;
    height: 120px;
    margin-bottom: 28px;
  }

  .avatar-ring::before,
  .avatar-ring::after {
    content: '';
    position: absolute;
    inset: -12px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.15);
    animation: pulse-ring 2s ease-out infinite;
  }

  .avatar-ring::after {
    inset: -28px;
    animation-delay: 0.6s;
  }

  @keyframes pulse-ring {
    0%   { opacity: 0.8; transform: scale(0.9); }
    100% { opacity: 0;   transform: scale(1.15); }
  }

  .avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    position: relative;
    z-index: 1;
  }

  .caller-name {
    font-size: 28px;
    font-weight: 600;
    color: #fff;
    margin-bottom: 8px;
    letter-spacing: 0.3px;
    text-align: center;
  }

  .call-label {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.55);
    font-weight: 400;
    letter-spacing: 0.5px;
  }

  .buttons-area {
    display: flex;
    justify-content: center;
    gap: 80px;
    width: 100%;
    padding-bottom: 16px;
  }

  .btn-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
  }

  .swipe-track {
    position: relative;
    width: 72px;
    height: 140px;
    border-radius: 36px;
    background: rgba(255, 255, 255, 0.06);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    overflow: visible;
  }

  .swipe-hint {
    position: absolute;
    top: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    opacity: 0.4;
    animation: hint-bounce 2s ease-in-out infinite;
  }

  .swipe-hint .chevron {
    width: 14px;
    height: 14px;
    border-left: 2px solid #fff;
    border-top: 2px solid #fff;
    transform: rotate(45deg);
  }

  @keyframes hint-bounce {
    0%, 100% { transform: translateY(0); opacity: 0.4; }
    50%      { transform: translateY(-6px); opacity: 0.7; }
  }

  .call-btn {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: relative;
    z-index: 2;
    margin-bottom: 4px;
    transition: box-shadow 0.2s ease;
    touch-action: none;
  }

  .call-btn.reject {
    background: linear-gradient(135deg, #ff4757 0%, #c0392b 100%);
    box-shadow: 0 4px 20px rgba(255, 71, 87, 0.4);
  }

  .call-btn.accept {
    background: linear-gradient(135deg, #2ed573 0%, #17a858 100%);
    box-shadow: 0 4px 20px rgba(46, 213, 115, 0.4);
  }

  .call-btn svg {
    width: 28px;
    height: 28px;
    fill: #fff;
  }

  .btn-label {
    font-size: 13px;
    color: rgba(255, 255, 255, 0.6);
    font-weight: 500;
  }

  .call-btn.swiping {
    transition: none;
  }

  .call-btn.activated {
    animation: btn-activate 0.35s ease-out forwards;
  }

  @keyframes btn-activate {
    0%   { transform: scale(1); }
    50%  { transform: scale(1.25); }
    100% { transform: scale(0); opacity: 0; }
  }

  .swipe-track.glow-reject::after {
    content: '';
    position: absolute;
    inset: -4px;
    border-radius: 40px;
    background: rgba(255, 71, 87, 0.15);
    animation: glow-fade 0.4s ease-out forwards;
  }

  .swipe-track.glow-accept::after {
    content: '';
    position: absolute;
    inset: -4px;
    border-radius: 40px;
    background: rgba(46, 213, 115, 0.15);
    animation: glow-fade 0.4s ease-out forwards;
  }

  @keyframes glow-fade {
    0%   { opacity: 1; }
    100% { opacity: 0; }
  }

  /* GIF Screen */
  .gif-screen {
    position: fixed;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: #0a0a0a;
    z-index: 5;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.6s ease;
  }

  .gif-screen.visible {
    opacity: 1;
    pointer-events: auto;
  }

  .gif-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
    transform: scale(0.8);
    opacity: 0;
    transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1), opacity 0.5s ease;
  }

  .gif-screen.visible .gif-container {
    transform: scale(1);
    opacity: 1;
    transition-delay: 0.2s;
  }

  .gif-display {
    width: min(85vw, 360px);
    border-radius: 20px;
    overflow: hidden;
    background: #111;
  }

  .gif-display img {
    width: 100%;
    height: auto;
    display: block;
  }

  .gif-text {
    color: rgba(255, 255, 255, 0.5);
    font-size: 15px;
    font-weight: 500;
    letter-spacing: 0.5px;
  }

  .back-btn {
    margin-top: 4px;
    padding: 14px 40px;
    border-radius: 30px;
    border: 1px solid rgba(255, 255, 255, 0.15);
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.2s ease;
  }

  .back-btn:active {
    background: rgba(255, 255, 255, 0.12);
  }

  .particle-overlay {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 20;
  }

  .particle {
    position: absolute;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #ff4757;
    opacity: 0;
    animation: particle-fly 0.7s ease-out forwards;
  }

  @keyframes particle-fly {
    0%   { opacity: 1; transform: translate(0, 0) scale(1); }
    100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0); }
  }

  /* Tap-to-start overlay */
  .tap-overlay {
    position: fixed;
    inset: 0;
    z-index: 100;
    background: linear-gradient(165deg, #1a1a2e 0%, #16213e 40%, #0f3460 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 24px;
    cursor: pointer;
    transition: opacity 0.4s ease;
  }

  .tap-overlay.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .tap-overlay .tap-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 2px solid rgba(255, 255, 255, 0.2);
    display: flex;
    align-items: center;
    justify-content: center;
    animation: tap-pulse 2s ease-in-out infinite;
  }

  .tap-overlay .tap-icon svg {
    width: 36px;
    height: 36px;
    fill: rgba(255, 255, 255, 0.7);
  }

  .tap-overlay .tap-text {
    color: rgba(255, 255, 255, 0.6);
    font-size: 18px;
    font-weight: 500;
    letter-spacing: 0.5px;
  }

  @keyframes tap-pulse {
    0%, 100% { transform: scale(1); border-color: rgba(255,255,255,0.2); }
    50%      { transform: scale(1.08); border-color: rgba(255,255,255,0.4); }
  }
</style>
</head>
<body>

<!-- Tap-to-start overlay (needed to unlock audio on mobile browsers) -->
<div class="tap-overlay" id="tapOverlay">
  <div class="tap-icon">
    <svg viewBox="0 0 24 24"><path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/></svg>
  </div>
  <div class="tap-text">Open Phone App</div>
</div>

<div class="call-screen" id="callScreen">
  <div class="caller-info">
    <div class="avatar-ring">
      <img class="avatar" src="callingavtar.jpeg" alt="Caller" />
    </div>
    <div class="caller-name">Will you be my Valentine ??</div>
    <div class="call-label">Incoming Call...</div>
  </div>

  <div class="buttons-area">
    <div class="btn-wrapper">
      <div class="swipe-track" id="rejectTrack">
        <div class="swipe-hint">
          <div class="chevron"></div>
          <div class="chevron"></div>
        </div>
        <button class="call-btn reject" id="rejectBtn">
          <svg viewBox="0 0 24 24"><path d="M12 9c-1.6 0-3.15.25-4.6.72v3.1c0 .39-.23.74-.56.9-.98.49-1.87 1.12-2.66 1.85-.18.18-.43.28-.7.28-.28 0-.53-.11-.71-.29L.29 13.08a.956.956 0 0 1-.29-.7c0-.28.11-.53.29-.71C3.34 8.78 7.46 7 12 7s8.66 1.78 11.71 4.67c.18.18.29.43.29.71 0 .28-.11.53-.29.71l-2.48 2.48c-.18.18-.43.29-.71.29-.27 0-.52-.1-.7-.28-.79-.74-1.68-1.36-2.66-1.85a.996.996 0 0 1-.56-.9v-3.1C15.15 9.25 13.6 9 12 9z"/></svg>
        </button>
      </div>
      <span class="btn-label">Decline</span>
    </div>

    <div class="btn-wrapper">
      <div class="swipe-track" id="acceptTrack">
        <div class="swipe-hint">
          <div class="chevron"></div>
          <div class="chevron"></div>
        </div>
        <button class="call-btn accept" id="acceptBtn">
          <svg viewBox="0 0 24 24"><path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 0 0-1.01.24l-1.57 1.97c-2.83-1.35-5.48-3.9-6.89-6.83l1.95-1.66c.27-.28.35-.67.24-1.02-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.19C3.65 3 3 3.24 3 3.99 3 13.28 10.73 21 20.01 21c.71 0 .99-.63.99-1.18v-3.45c0-.54-.45-.99-.99-.99z"/></svg>
        </button>
      </div>
      <span class="btn-label">Accept</span>
    </div>
  </div>
</div>

<div class="gif-screen" id="gifScreen">
  <div class="gif-container">
    <div class="gif-display">
      <img src="tenor.gif" alt="GIF" />
    </div>
    <div class="gif-text">Bubu is my Valentine !!!</div>
    <button class="back-btn" id="backBtn">Back</button>
  </div>
</div>

<div class="particle-overlay" id="particleOverlay"></div>

<script>
(function () {
  /* ── Ringtone (callertune.mp3) & Vibration ── */
  var ringtoneAudio = new Audio('callertune.mp3');
  ringtoneAudio.loop = true;
  var acceptedAudio = new Audio('acceptedCall.mp3');
  acceptedAudio.loop = true;
  var vibrationInterval = null;
  var isRinging = false;

  function startRinging() {
    if (isRinging) return;
    isRinging = true;

    // Play the mp3 ringtone
    ringtoneAudio.currentTime = 0;
    ringtoneAudio.play().catch(function () {});

    // Vibration: use native API if available (Android/Chrome)
    if ('vibrate' in navigator) {
      // Continuous vibration pattern: 500ms on, 300ms off — repeating
      function vibrateCycle() {
        if (!isRinging) return;
        navigator.vibrate([500, 300, 500, 300, 500]);
      }
      vibrateCycle();
      vibrationInterval = setInterval(function () {
        if (isRinging) vibrateCycle();
      }, 2600);
    }
  }

  function stopRinging() {
    isRinging = false;
    ringtoneAudio.pause();
    ringtoneAudio.currentTime = 0;
    if (vibrationInterval) { clearInterval(vibrationInterval); vibrationInterval = null; }
    if ('vibrate' in navigator) navigator.vibrate(0);
  }

  /* ── Tap-to-start overlay ── */
  var tapOverlay = document.getElementById('tapOverlay');
  tapOverlay.addEventListener('click', function () {
    tapOverlay.classList.add('hidden');
    startRinging();
  });

  /* ── Swipe Logic ── */
  var SWIPE_THRESHOLD = 80;
  var callScreen  = document.getElementById('callScreen');
  var gifScreen   = document.getElementById('gifScreen');
  var backBtn     = document.getElementById('backBtn');
  var particleOvl = document.getElementById('particleOverlay');

  function setupSwipe(btnEl, trackEl, onActivate) {
    var startY = 0;
    var currentY = 0;
    var dragging = false;

    function pointerDown(e) {
      e.preventDefault();
      dragging = true;
      startY = e.touches ? e.touches[0].clientY : e.clientY;
      currentY = startY;
      btnEl.classList.add('swiping');
    }

    function pointerMove(e) {
      if (!dragging) return;
      e.preventDefault();
      var y = e.touches ? e.touches[0].clientY : e.clientY;
      currentY = y;
      var delta = Math.min(0, currentY - startY);
      var clamped = Math.max(delta, -SWIPE_THRESHOLD - 30);
      btnEl.style.transform = 'translateY(' + clamped + 'px)';
      var progress = Math.min(1, Math.abs(delta) / SWIPE_THRESHOLD);
      trackEl.style.background = 'rgba(255,255,255,' + (0.06 + progress * 0.08) + ')';
    }

    function pointerUp() {
      if (!dragging) return;
      dragging = false;
      btnEl.classList.remove('swiping');
      var delta = startY - currentY;
      if (delta >= SWIPE_THRESHOLD) {
        btnEl.classList.add('activated');
        onActivate();
      } else {
        btnEl.style.transition = 'transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)';
        btnEl.style.transform = 'translateY(0)';
        trackEl.style.background = '';
        setTimeout(function() { btnEl.style.transition = ''; }, 300);
      }
    }

    btnEl.addEventListener('touchstart', pointerDown, { passive: false });
    document.addEventListener('touchmove', pointerMove, { passive: false });
    document.addEventListener('touchend', pointerUp);
    btnEl.addEventListener('mousedown', pointerDown);
    document.addEventListener('mousemove', pointerMove);
    document.addEventListener('mouseup', pointerUp);
  }

  function burstParticles(x, y) {
    var count = 18;
    for (var i = 0; i < count; i++) {
      var p = document.createElement('div');
      p.className = 'particle';
      var angle = (Math.PI * 2 / count) * i;
      var dist = 60 + Math.random() * 80;
      p.style.left = x + 'px';
      p.style.top = y + 'px';
      p.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
      p.style.setProperty('--ty', Math.sin(angle) * dist + 'px');
      p.style.background = ['#ff4757','#ff6b81','#ffa502','#ff6348'][Math.floor(Math.random()*4)];
      particleOvl.appendChild(p);
      setTimeout(function(el){ el.remove(); }, 800, p);
    }
  }

  function handleReject() {
    stopRinging();
    var rect = document.getElementById('rejectBtn').getBoundingClientRect();
    burstParticles(rect.left + rect.width / 2, rect.top + rect.height / 2);
    setTimeout(function() {
      callScreen.classList.add('hidden');
      gifScreen.classList.add('visible');
      // Play accepted call audio on GIF screen
      acceptedAudio.currentTime = 0;
      acceptedAudio.play().catch(function () {});
    }, 300);
  }

  function handleAccept() {
    stopRinging();
    var btn = document.getElementById('acceptBtn');
    var track = document.getElementById('acceptTrack');
    track.classList.add('glow-accept');
    setTimeout(function() {
      btn.classList.remove('activated');
      btn.style.transform = 'translateY(0)';
      btn.style.transition = 'transform 0.3s ease';
      track.style.background = '';
      track.classList.remove('glow-accept');
      setTimeout(function() { btn.style.transition = ''; }, 300);
    }, 400);
  }

  backBtn.addEventListener('click', function () {
    // Stop accepted call audio
    acceptedAudio.pause();
    acceptedAudio.currentTime = 0;
    gifScreen.classList.remove('visible');
    setTimeout(function() {
      callScreen.classList.remove('hidden');
      var rejectBtn = document.getElementById('rejectBtn');
      rejectBtn.classList.remove('activated');
      rejectBtn.style.transform = '';
      rejectBtn.style.transition = '';
      document.getElementById('rejectTrack').style.background = '';
      // Restart ringing when returning to call screen
      startRinging();
    }, 500);
  });

  setupSwipe(
    document.getElementById('rejectBtn'),
    document.getElementById('rejectTrack'),
    handleReject
  );

  setupSwipe(
    document.getElementById('acceptBtn'),
    document.getElementById('acceptTrack'),
    handleAccept
  );
})();
</script>
</body>
</html>
